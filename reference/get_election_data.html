<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function to get jointly information on polling stations and votes for candidacies. — get_election_data • pollspain</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Function to get jointly information on polling stations and votes for candidacies. — get_election_data"><meta name="description" content="Import and preprocess poll stations info but jointly
with the preprocessed candidacies data, for given election types
and dates, at poll station level. This function supports both
single values and vector inputs for fetching and combining data
for multiple elections at once."><meta property="og:description" content="Import and preprocess poll stations info but jointly
with the preprocessed candidacies data, for given election types
and dates, at poll station level. This function supports both
single values and vector inputs for fetching and combining data
for multiple elections at once."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pollspain</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/about-data.html">About data</a></li>
    <li><a class="dropdown-item" href="../articles/utils.html">How to use utils functions?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dadosdelaplace/pollspain/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function to get jointly information on polling stations and votes for candidacies.</h1>
      <small class="dont-index">Source: <a href="https://github.com/dadosdelaplace/pollspain/blob/main/R/get_elections_data.R" class="external-link"><code>R/get_elections_data.R</code></a></small>
      <div class="d-none name"><code>get_election_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Import and preprocess poll stations info but jointly
with the preprocessed candidacies data, for given election types
and dates, at poll station level. This function supports both
single values and vector inputs for fetching and combining data
for multiple elections at once.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_election_data</span><span class="op">(</span></span>
<span>  <span class="va">type_elec</span>,</span>
<span>  year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prec_round <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  short_version <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-type-elec">type_elec<a class="anchor" aria-label="anchor" href="#arg-type-elec"></a></dt>
<dd><p>Type elections for which data is available.
It should be one of the following values: "referendum",
"congress", "senate", "local", "cabildo" (Canarian council)
or "EU".</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>A vector or single value representing the years of the
elections to be considered. Please, check in
<code>dates_elections_spain</code> that elections of the specified type
are available for the provided year.</p></dd>


<dt id="arg-date">date<a class="anchor" aria-label="anchor" href="#arg-date"></a></dt>
<dd><p>A vector or single value representing the dates of
the elections to be considered. If date was provided, it should be
in format %Y-%m-%d (e.g., '2000-01-01'). Defaults to <code>NULL</code>.
If no date was provided, <code>year</code> should be provided as
numerical variable. Please, check in <code>dates_elections_spain</code>
that elections of the specified type are available.</p></dd>


<dt id="arg-prec-round">prec_round<a class="anchor" aria-label="anchor" href="#arg-prec-round"></a></dt>
<dd><p>Rounding accuracy. Defaults to
<code>prec_round = 3</code>.</p></dd>


<dt id="arg-short-version">short_version<a class="anchor" aria-label="anchor" href="#arg-short-version"></a></dt>
<dd><p>Flag to indicate whether it should be returned
a short version of the data (just key variables) or not.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Flag to indicate whether detailed messages should
be printed during execution. Defaults to <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with rows corresponding to poll-stations for
each election, including the following variables:</p>
<dl><dt>id_elec</dt>
<dd><p>election's id constructed from the election code
<code>cod_elec</code> and date <code>date_elec</code>.</p></dd>

<dt>cod_elec</dt>
<dd><p>code representing the type of election:
<code>"01"</code> (referendum), <code>"02"</code> (congress),
<code>"03"</code> (senate), <code>"04"</code> (local elections),
<code>"06"</code> (cabildo - Canarian council - elections), <code>"07"</code>
(European Parliament elections). Variable available only for
long version.</p></dd>

<dt>type_election</dt>
<dd><p>type of the election.</p></dd>

<dt>date_elec</dt>
<dd><p>date of the election. Variable available only for
long version.</p></dd>

<dt>id_INE_poll_station</dt>
<dd><p>poll station's id constructed from the
ccaa-prov-municipality and poll station codes.</p></dd>

<dt>id_INE_mun</dt>
<dd><p>municipality ID constructed from the
ccaa-prov-mun codes provided by INE.</p></dd>

<dt>cod_INE_ccaa, ccaa</dt>
<dd><p>codes and names for regions (ccaa)
to which the municipalities belong. Codes available only for
long version.</p></dd>

<dt>cod_INE_prov, prov</dt>
<dd><p>codes and names for the provinces to which
the municipalities belong. Codes available only for long version.</p></dd>

<dt>cod_INE_mun, mun</dt>
<dd><p>code, and name for
municipalities. Codes available only for long version.</p></dd>

<dt>cod_mun_district, cod_sec, cod_poll_station</dt>
<dd><p>codes for the
municipal district, census tract and poll station. They are
only available for long version.</p></dd>

<dt>ballots_1, turnout_1</dt>
<dd><p>number of total ballots and turnout
percentage in the first round. Variables available only for
long version.</p></dd>

<dt>ballots_2, turnout_2</dt>
<dd><p>number of total ballots and turnout
percentage in the second round (if applicable). Variables available
only for long version</p></dd>

<dt>blank_ballots, invalid_ballots</dt>
<dd><p>blank and invalid ballots.</p></dd>

<dt>party_ballots, valid_ballots, total_ballots</dt>
<dd><p>ballots to
candidacies/parties, valid ballots (sum of <code>blank_ballots</code> and
<code>party_ballots</code>) and total ballots (sum of
<code>valid_ballots</code> and <code>invalid_ballots</code>).</p></dd>

<dt>turnout</dt>
<dd><p>final turnout percentage. It is only
available for long version.</p></dd>

<dt>porc_valid, porc_invalid, porc_parties, porc_blank</dt>
<dd><p>perc (%)
values of <code>valid_ballots</code>, <code>invalid_ballots</code>,
<code>party_ballots</code> and <code>blank_ballots</code>.</p></dd>

<dt>n_poll_stations</dt>
<dd><p>number of polling stations. It is only
available for long version.</p></dd>

<dt>pop_res_mun</dt>
<dd><p>population census of residents (CER + CERA) at
municipality level.</p></dd>

<dt>census_counting_mun</dt>
<dd><p>population eligible to vote after claims
at municipality level.</p></dd>

<dt>id_candidacies</dt>
<dd><p>id for candidacies at province level.</p></dd>

<dt>id_candidacies_ccaa, id_candidacies_nat</dt>
<dd><p>id for candidacies
at ccaa level (only provided for long version) and at national
level.</p></dd>

<dt>abbrev_candidacies, name_candidacies</dt>
<dd><p>acronym and full name
of the candidacies. They are only available for long version.</p></dd>

<dt>ballots</dt>
<dd><p>number of ballots obtained for each candidacy at
each poll station.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The purpose of this function is to easily combine the
outputs of <code><a href="import_poll_station_data.html">import_poll_station_data()</a></code>,
<code><a href="import_mun_census_data.html">import_mun_census_data()</a></code>, and
<code><a href="import_candidacies_data.html">import_candidacies_data()</a></code>, providing a tibble at the
polling station level with both general voting data (blank votes,
null votes, etc.) and votes for each candidacy (identified by
their corresponding ids). This function does not perform
aggregations and is not intended as a final-use tool for basic
users, but rather as an intermediate step for the
<code><a href="summary_election_data.html">summary_election_data()</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Javier Alvarez-Liebana and David Pereiro-Pol.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Correct examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Congress elections in year 2008, 2016 and "2023-07-24"</span></span></span>
<span class="r-in"><span><span class="co"># in a short version</span></span></span>
<span class="r-in"><span><span class="va">elections_data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">get_election_data</span><span class="op">(</span>type_elec <span class="op">=</span> <span class="st">"congress"</span>, year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2008</span>, <span class="fl">2016</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    date <span class="op">=</span> <span class="st">"2023-07-24"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">... Check if parameters are allowed...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">[x] Import poll station data ...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">   ... congress elections on 2008-03-09</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">   ... congress elections on 2016-06-26</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">   ... congress elections on 2023-07-24</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">[x] Import candidacies and ballots data (at poll station level) ...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB;">   ... please wait, volume of data downloaded and internet connection may take a few seconds</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">A short version was asked (if you want all variables, run with `short_version = FALSE`)</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Congress elections in 2008 in a long version</span></span></span>
<span class="r-in"><span><span class="va">elections_data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">get_election_data</span><span class="op">(</span>type_elec <span class="op">=</span> <span class="st">"congress"</span>, year <span class="op">=</span> <span class="fl">2008</span>,</span></span>
<span class="r-in"><span>                    short_version <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">... Check if parameters are allowed...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">[x] Import poll station data ...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">   ... congress elections on 2008-03-09</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">[x] Import candidacies and ballots data (at poll station level) ...</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB;">   ... please wait, volume of data downloaded and internet connection may take a few seconds</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># ----</span></span></span>
<span class="r-in"><span><span class="co"># Incorrect examples</span></span></span>
<span class="r-in"><span><span class="co"># ----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Invalid election type: "national" is not a valid election type</span></span></span>
<span class="r-in"><span><span class="fu">get_election_data</span><span class="op">(</span>type_elec <span class="op">=</span> <span class="st">"national"</span>, year <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Invalid date format: date should be in %Y-%m-%d format</span></span></span>
<span class="r-in"><span><span class="fu">get_election_data</span><span class="op">(</span>type_elec <span class="op">=</span> <span class="st">"congress"</span>, date <span class="op">=</span> <span class="st">"26-06-2016"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Invalid short version flag: short_version should be a</span></span></span>
<span class="r-in"><span><span class="co"># logical variable</span></span></span>
<span class="r-in"><span><span class="fu">get_election_data</span><span class="op">(</span>type_elec <span class="op">=</span> <span class="st">"congress"</span>, year <span class="op">=</span> <span class="fl">2019</span>,</span></span>
<span class="r-in"><span>                  short_version <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Javier Álvarez-Liébana, David Pereiro-Pol, Mafalda González-González, Irene Bosque-Gala, Mikaela De Smedt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

